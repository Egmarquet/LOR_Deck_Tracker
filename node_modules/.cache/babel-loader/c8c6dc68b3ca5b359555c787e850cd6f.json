{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport React, { Component, useState, useEffect, useRef } from \"react\";\nimport { Window, App } from \"proton-native\"; // import the proton-native components\n\nvar axios = require('axios');\n\nimport { useInterval, isEmpty } from \"./components/tools\";\n\nvar cardData = require(\"./components/card_data.json\");\n\nfunction MainApp() {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      deckActive = _useState2[0],\n      setDeckActive = _useState2[1];\n\n  var _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      errState = _useState4[0],\n      setErrorState = _useState4[1]; // Maps CardID to CardCode\n\n\n  var _useState5 = useState({}),\n      _useState6 = _slicedToArray(_useState5, 2),\n      handHistory = _useState6[0],\n      setHandHistory = _useState6[1]; // Maps CardID to current count of cards in deck\n\n\n  var _useState7 = useState({}),\n      _useState8 = _slicedToArray(_useState7, 2),\n      currDeckList = _useState8[0],\n      setCurrDeckList = _useState8[1]; // Server polling circuit\n\n\n  useInterval(function () {\n    if (!deckActive) {\n      getInitialState();\n    } else {\n      updateDeckState();\n    }\n  }, 1100); // Setting initial deck state if a new deck deck is detected\n\n  var getInitialState = function getInitialState() {\n    axios.get('http://127.0.0.1:21337/static-decklist').then(function (response) {\n      if (response.data.DeckCode != null && !isEmpty(response.data.CardsInDeck)) {\n        var initialDeckList = {};\n        console.log(response.data);\n\n        for (var cardCode in response.data.CardsInDeck) {\n          initialDeckList[cardCode] = {\n            name: cardData[cardCode].name,\n            cost: cardData[cardCode].cost,\n            count: response.data.CardsInDeck[cardCode]\n          };\n        }\n\n        setCurrDeckList(initialDeckList);\n        setDeckActive(true);\n      } else {\n        console.log(\"Waiting for game\");\n      }\n    })[\"catch\"](function (error) {\n      console.log(\"LOR window is not active\");\n    });\n  };\n  /*\n  Parsing rectangle API for the data:\n   Get current hand state:\n    - compare to previous hand state and get difference\n    - subtract from deck if new on board\n  */\n\n\n  var updateDeckState = function updateDeckState() {\n    axios.get('http://127.0.0.1:21337/positional-rectangles').then(function (response) {\n      if (response.data.GameState == \"Menus\") {\n        //cleanup\n        setHandHistory({});\n        setDeckActive({});\n        setDeckActive(false);\n      } else {\n        var height = response.data.Screen.ScreenHeight;\n        var width = response.data.Screen.ScreenWidth;\n        var newCards = {}; //Iterate over rectangles and collect new cards not found in handhistory\n        // Map the unique { cardID : cardCode }\n\n        response.data.Rectangles.forEach(function (item, index) {\n          if (item.LocalPlayer && item.CardCode != \"face\" && item.TopLeftY <= 0.5 * height && !(item.CardID in handHistory)) {\n            newCards[item.CardID] = item.CardCode;\n          }\n        }); // If there are new cards this update\n\n        if (!isEmpty(newCards)) {\n          var newDeckState = Object.assign({}, currDeckList);\n          var newHandHistory = Object.assign({}, handHistory); // For each new card, subtract 1 count from the deck state\n          // and update the hand history\n\n          for (var key in newCards) {\n            if (newCards[key] in currDeckList) {\n              newDeckState[newCards[key]].count = newDeckState[newCards[key]].count - 1;\n            }\n\n            newHandHistory[key] = newCards[key];\n          }\n\n          setHandHistory(newHandHistory);\n          setCurrDeckList(newDeckState);\n        }\n      }\n    })[\"catch\"](function (error) {\n      console.log(error);\n    });\n  };\n\n  return React.createElement(View, null);\n}\n\nvar Temp = /*#__PURE__*/function (_Component) {\n  _inherits(Temp, _Component);\n\n  function Temp() {\n    _classCallCheck(this, Temp);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Temp).apply(this, arguments));\n  }\n\n  _createClass(Temp, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(View, null, React.createElement(Text, null, \"Hello World!\"));\n    }\n  }]);\n\n  return Temp;\n}(Component);\n\nvar Example = /*#__PURE__*/function (_Component2) {\n  _inherits(Example, _Component2);\n\n  function Example() {\n    _classCallCheck(this, Example);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Example).apply(this, arguments));\n  }\n\n  _createClass(Example, [{\n    key: \"render\",\n    value: function render() {\n      // all Components must have a render method\n      return React.createElement(App, null, React.createElement(Window, {\n        style: {\n          width: 300,\n          height: 300\n        }\n      }, Temp));\n    }\n  }]);\n\n  return Example;\n}(Component);\n\nexport { Example as default };","map":{"version":3,"sources":["C:/Users/Etienne/Documents/Github/my-app/app.js"],"names":["React","Component","useState","useEffect","useRef","Window","App","axios","require","useInterval","isEmpty","cardData","MainApp","deckActive","setDeckActive","errState","setErrorState","handHistory","setHandHistory","currDeckList","setCurrDeckList","getInitialState","updateDeckState","get","then","response","data","DeckCode","CardsInDeck","initialDeckList","console","log","cardCode","name","cost","count","error","GameState","height","Screen","ScreenHeight","width","ScreenWidth","newCards","Rectangles","forEach","item","index","LocalPlayer","CardCode","TopLeftY","CardID","newDeckState","Object","assign","newHandHistory","key","Temp","Example"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect, useRef } from \"react\";\nimport { Window, App } from \"proton-native\"; // import the proton-native components\nconst axios = require('axios');\nimport { useInterval, isEmpty } from \"./components/tools\"\nconst cardData = require(\"./components/card_data.json\")\n\n\nfunction MainApp(){\n  const [deckActive, setDeckActive] = useState(false);\n  const [errState, setErrorState] = useState({});\n\n  // Maps CardID to CardCode\n  const [handHistory, setHandHistory] = useState({});\n\n  // Maps CardID to current count of cards in deck\n  const [currDeckList, setCurrDeckList] = useState({});\n\n  // Server polling circuit\n  useInterval(() => {\n    if (!deckActive){\n      getInitialState();\n    }\n    else{\n      updateDeckState();\n    }\n  }, 1100);\n\n  // Setting initial deck state if a new deck deck is detected\n  const getInitialState = () => {\n    axios.get('http://127.0.0.1:21337/static-decklist')\n      .then(function (response){\n        if ((response.data.DeckCode) != null && !isEmpty(response.data.CardsInDeck)){\n          const initialDeckList = {}\n          console.log(response.data)\n          for(var cardCode in response.data.CardsInDeck){\n            initialDeckList[cardCode] = {\n              name: cardData[cardCode].name,\n              cost: cardData[cardCode].cost,\n              count: response.data.CardsInDeck[cardCode]\n            }\n          }\n          setCurrDeckList(initialDeckList);\n          setDeckActive(true);\n        }\n        else{\n          console.log(\"Waiting for game\")\n        }\n      })\n      .catch(function (error) {\n        console.log(\"LOR window is not active\");\n      })\n  }\n\n  /*\n  Parsing rectangle API for the data:\n\n  Get current hand state:\n    - compare to previous hand state and get difference\n    - subtract from deck if new on board\n  */\n  const updateDeckState = () => {\n\n    axios.get('http://127.0.0.1:21337/positional-rectangles')\n      .then(function (response){\n          if (response.data.GameState == \"Menus\"){\n            //cleanup\n            setHandHistory({})\n            setDeckActive({})\n            setDeckActive(false)\n          }\n\n          else {\n\n            const height = response.data.Screen.ScreenHeight\n            const width = response.data.Screen.ScreenWidth\n            const newCards = {}\n\n            //Iterate over rectangles and collect new cards not found in handhistory\n            // Map the unique { cardID : cardCode }\n            response.data.Rectangles.forEach(function (item, index) {\n              if (item.LocalPlayer && item.CardCode != \"face\" && item.TopLeftY <= 0.5*height && !(item.CardID in handHistory)){\n                newCards[item.CardID] = item.CardCode\n              }\n            });\n\n            // If there are new cards this update\n            if (!isEmpty(newCards)) {\n\n              let newDeckState = Object.assign({}, currDeckList);\n              let newHandHistory = Object.assign({}, handHistory);\n\n              // For each new card, subtract 1 count from the deck state\n              // and update the hand history\n              for (const key in newCards) {\n                if (newCards[key] in currDeckList) {\n                  newDeckState[newCards[key]].count = newDeckState[newCards[key]].count - 1;\n                }\n                newHandHistory[key] = newCards[key];\n              }\n              setHandHistory(newHandHistory);\n              setCurrDeckList(newDeckState);\n            }\n          }\n      })\n\n      .catch(function (error) {\n        console.log(error);\n      });\n    }\n\n    return(\n      <View></View>\n    );\n}\n\nclass Temp extends Component{\n  render(){\n    return(<View><Text>Hello World!</Text></View>);\n  }\n}\n\nexport default class Example extends Component {\n  render() {\n    // all Components must have a render method\n    return (\n      <App>\n        {/* you must always include App around everything */}\n        <Window style={{ width: 300, height: 300}}>\n          {Temp}\n        </Window>\n      </App>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}